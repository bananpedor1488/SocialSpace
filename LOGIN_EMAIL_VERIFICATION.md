# Подтверждение Email при Логине

## Описание функциональности

Теперь при попытке входа в аккаунт с неподтвержденным email адресом, пользователь будет автоматически перенаправлен на страницу подтверждения email.

## Как это работает

### 1. Попытка входа
- Пользователь вводит email и пароль
- Система проверяет учетные данные
- Если email не подтвержден, сервер возвращает статус 403 с флагом `requiresVerification: true`

### 2. Перенаправление на подтверждение
- Клиент автоматически переключается на компонент EmailVerification
- Устанавливается флаг `isFromLogin: true`
- Отображается соответствующее сообщение

### 3. Подтверждение email
- Пользователь вводит код подтверждения
- После успешного подтверждения происходит автоматический вход в аккаунт
- Пользователь перенаправляется на главную страницу

## Изменения в коде

### Серверная часть (auth.js)
- Маршрут `/login` возвращает статус 403 для неподтвержденных пользователей
- Включает `requiresVerification: true` и `userId` в ответ

### Клиентская часть (AuthPage.jsx)
- Добавлена обработка статуса 403 с флагом `requiresVerification`
- Автоматическое переключение на EmailVerification
- Правильная обработка возврата к форме входа

### EmailVerification.jsx
- Обновлены сообщения для случая логина
- Добавлена кнопка "Назад к входу" для случая логина
- Улучшены тексты сообщений

## Сообщения пользователю

### При попытке входа с неподтвержденным email:
- "Email не подтвержден. Проверьте почту и подтвердите регистрацию"

### На странице подтверждения для логина:
- Заголовок: "Подтвердите email для входа"
- Подзаголовок: "Для входа в аккаунт необходимо подтвердить email. Код отправлен на [email]"
- Примечание: "После подтверждения email вы сможете войти в аккаунт"

### После успешного подтверждения:
- "Email подтвержден! Теперь вы можете войти в аккаунт"
- "Email подтвержден! Добро пожаловать: [username]"

## Тестирование

1. Создайте аккаунт с email, но не подтверждайте его
2. Попробуйте войти с этим email и паролем
3. Должно произойти автоматическое перенаправление на страницу подтверждения
4. Введите код подтверждения
5. После подтверждения должен произойти автоматический вход

## Безопасность

- Пользователь не может войти в аккаунт без подтверждения email
- Код подтверждения действителен 10 минут
- Можно запросить новый код каждые 60 секунд
- Все попытки входа логируются на сервере
